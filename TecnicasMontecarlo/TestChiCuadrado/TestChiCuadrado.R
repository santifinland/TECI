# Test Chi cuadrado Exponencial

# Datos
x <- c(4.8836, 2.3710, 5.4863, 0.4128, 0.5140, 3.5525, 0.0100, 0.1258, 0.6072, 0.0385,
       1.8700, 2.0893, 0.3445, 2.1685, 2.1992, 0.7800, 3.5711, 1.0869, 1.6796, 4.9266,
       3.3049, 0.3198, 0.8513, 0.8234, 0.3551, 0.2849, 1.9687, 0.9654, 0.8164, 3.9926,
       6.6115, 2.0679, 0.7423, 0.8220, 7.6054, 0.0406, 6.2950, 8.3504, 2.0288, 1.5100,
       2.2095, 8.9253, 0.4075, 5.7358, 0.1409, 6.0335, 0.2485, 2.4816, 0.6662, 1.0702)
x <- c(1.433, 0.074, 2.849, 0.418, 1.670, 1.667, 1.404, 0.484, 1.073, 0.080, 0.433, 0.177, 0.437, 1.042, 0.115, 3.940, 0.532, 0.754, 2.097, 1.809, 2.789, 1.167, 0.564, 2.411, 3.411, 2.392, 0.212, 2.577, 2.329, 1.360, 0.746, 0.183, 2.153, 0.674, 0.358, 3.176, 0.414, 3.092, 0.394, 1.300, 0.717, 0.439, 0.600, 0.340, 1.493, 0.813, 0.291, 0.495, 0.422, 2.286, 0.299, 1.050, 1.384, 0.113, 0.430, 0.295, 0.723, 0.295, 0.608, 1.110, 0.600, 1.173, 0.205, 0.298, 1.615, 1.824, 3.145, 0.658, 2.037, 0.359, 1.434, 2.092, 2.972, 0.161, 0.572, 2.701, 2.591, 3.482, 0.277, 5.841, 3.865, 0.045, 1.359, 1.964, 0.666, 0.579, 0.104, 0.375, 1.887, 1.328, 2.166, 0.067, 0.450, 3.659, 0.028, 1.737, 1.143, 1.704, 0.068, 1.696)

l <- 1 / mean(x)

# Numero de intervalos
k <- 10 
p <- 1 / k

# Amplitud de intervalos
a <- c(0)
for (i in seq(from = 1, to = k)) {
  newa <- (-1 / l) * log(1 - i * p)
  a <- c(a, newa)
}

# Observaciones esperadas en cada intevalo
e <- rep(1, k) * (length(x) / k)

# Calculamos las osbervaciones dentro de cada intervalo
o <- rep(0, k)
chi <- rep(0, k)
for (i in seq(from = 1, to = k)) {
  print(paste(a[i], a[i+1])) 
  for (j in seq(from = 1, to = length(x))) {
    if ((x[j] > a[i]) && (x[j] < a[i+1])) {
      o[i] <- o[i] + 1
    } 
  }
  # calculamos el estadÃ­stico
  chi[i] <- (o[i] - e[i])^2 / e[i] 
}

# p-value
pval <- pchisq(sum(chi), k - 2, lower.tail = FALSE) 
